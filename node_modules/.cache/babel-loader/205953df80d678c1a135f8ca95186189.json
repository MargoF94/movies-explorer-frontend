{"ast":null,"code":"export var mainApiUrl='http://localhost:3000';var checkResponse=function checkResponse(res){if(res.ok){return res.json();}return Promise.reject(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \".concat(res.status));};//// ПОЛЬЗОВАТЕЛЬСКОЕ ////\n// Логинl\nexport var login=function login(email,password){return fetch(\"\".concat(mainApiUrl,\"/api/signin\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})}).then(function(data){if(data){console.log(\"Response data from api after successful login: \".concat(data));localStorage.setItem('jwt',data.jwt);return data.json();}});};// Регистрация\nexport var register=function register(email,password,name){return fetch(\"\".concat(mainApiUrl,\"/api/signup\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password,name:name})});};// Проверка токена\n// Получение информации о пользователе\nexport var getContent=function getContent(jwt){return fetch(\"\".concat(mainApiUrl,\"/api/users/me\"),{method:'GET',headers:{'Content-Type':'application/json','Authorization':\"\".concat(jwt)}}).then(function(res){console.log(\"In auth.getContent: response: \".concat(res));return res.json();});};// Изменение информации о пользователе\nexport var editProfile=function editProfile(name,email){return fetch(\"\".concat(mainApiUrl,\"/api/users/me\"),{method:'PATCH',headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"\".concat(localStorage.getItem('jwt'))},body:JSON.stringify({name:name,email:email})}).then(checkResponse);};//// КАРТОЧКИ ////\n// Создание фильма\n// Сохраняем пришедший с API фильм локально\nexport var createLocalCard=function createLocalCard(movie){console.log(\"IN SAVE API MOVIE: \".concat(JSON.stringify(movie.image.url)));return fetch(\"\".concat(mainApiUrl,\"/api/movies\"),{method:'POST',headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"\".concat(localStorage.getItem('jwt'))},body:JSON.stringify({country:movie.country,director:movie.director,duration:movie.duration,year:movie.year,description:movie.description,image:\"https://api.nomoreparties.co\".concat(movie.image.url),trailerLink:movie.trailerLink||'',thumbnail:\"https://api.nomoreparties.co\".concat(movie.image.formats.thumbnail.url),movieId:movie.id,nameRU:movie.nameRU||'',nameEN:movie.nameEN||''})}).then(checkResponse);};// Снятие лайка\nexport var deleteLocalMovie=function deleteLocalMovie(movieId){return fetch(\"\".concat(mainApiUrl,\"/api/movies/\").concat(movieId),{method:'DELETE',headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"\".concat(localStorage.getItem('jwt'))}}).then(checkResponse);};// Получение сохраненных карточек\nexport var getSavedMovies=function getSavedMovies(){return fetch(\"\".concat(mainApiUrl,\"/api/movies\"),{method:'GET',headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"\".concat(localStorage.getItem('jwt'))}}).then(checkResponse);};","map":{"version":3,"names":["mainApiUrl","checkResponse","res","ok","json","Promise","reject","status","login","email","password","fetch","method","headers","body","JSON","stringify","then","data","console","log","localStorage","setItem","jwt","register","name","getContent","editProfile","getItem","createLocalCard","movie","image","url","country","director","duration","year","description","trailerLink","thumbnail","formats","movieId","id","nameRU","nameEN","deleteLocalMovie","getSavedMovies"],"sources":["/Users/localmoyashi/dev/movies-explorer-frontend/src/utils/MainApi.js"],"sourcesContent":["export const mainApiUrl = 'http://localhost:3000';\n\nconst checkResponse = (res) => {\n  if (res.ok) {\n    return res.json()\n  }\n  return Promise.reject(`Ошибка ${res.status}`);\n}\n\n//// ПОЛЬЗОВАТЕЛЬСКОЕ ////\n\n// Логинl\n\nexport const login = (email, password) => {\n  return fetch(`${mainApiUrl}/api/signin`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ email, password })\n  })\n  .then((data) => {\n    if (data) {\n      console.log(`Response data from api after successful login: ${data}`);\n      localStorage.setItem('jwt', data.jwt);\n      return data.json();\n    }\n  })\n}\n\n// Регистрация\n\nexport const register = ( email, password, name ) => {\n  return fetch(`${mainApiUrl}/api/signup`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({email, password, name})\n  })\n}\n\n  // Проверка токена\n  // Получение информации о пользователе\n\nexport const getContent = (jwt) => {\n  return fetch(`${mainApiUrl}/api/users/me`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `${jwt}`,\n    },\n  })\n  .then((res) => {\n    console.log(`In auth.getContent: response: ${res}`);\n    return res.json();\n  })\n}\n\n\n// Изменение информации о пользователе\n\nexport const editProfile = ( name, email ) => {\n  return fetch(`${mainApiUrl}/api/users/me`, {\n    method: 'PATCH',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `${localStorage.getItem('jwt')}`\n    },\n    body: JSON.stringify({\n      name: name,\n      email: email\n    })\n  })\n  .then(checkResponse)\n}\n\n\n//// КАРТОЧКИ ////\n\n// Создание фильма\n// Сохраняем пришедший с API фильм локально\n\nexport const createLocalCard = (movie) => {\n  console.log(`IN SAVE API MOVIE: ${JSON.stringify(movie.image.url)}`);\n  return fetch(`${mainApiUrl}/api/movies`, {\n    method: 'POST',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `${localStorage.getItem('jwt')}`\n    }, \n    body: JSON.stringify({\n      country: movie.country,\n      director: movie.director,\n      duration: movie.duration,\n      year: movie.year,\n      description: movie.description,\n      image: `https://api.nomoreparties.co${movie.image.url}`,\n      trailerLink: movie.trailerLink || '',\n      thumbnail: `https://api.nomoreparties.co${movie.image.formats.thumbnail.url}`,\n      movieId: movie.id,\n      nameRU: movie.nameRU || '',\n      nameEN: movie.nameEN || '',\n    })\n  })\n  .then(checkResponse)\n}\n\n// Снятие лайка\n\nexport const deleteLocalMovie = (movieId) => {\n  return fetch(`${mainApiUrl}/api/movies/${movieId}`, {\n    method: 'DELETE',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `${localStorage.getItem('jwt')}`\n    }\n  })\n  .then(checkResponse)\n}\n\n// Получение сохраненных карточек\n\nexport const getSavedMovies = () => {\n  return fetch(`${mainApiUrl}/api/movies`, {\n    method: 'GET',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": `${localStorage.getItem('jwt')}`\n    }\n  })\n  .then(checkResponse)\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}