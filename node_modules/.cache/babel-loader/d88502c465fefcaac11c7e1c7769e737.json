{"ast":null,"code":"var _jsxFileName = \"/Users/localmoyashi/dev/movies-explorer-frontend/src/components/App/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { Route, Switch, useHistory, useLocation } from 'react-router-dom';\nimport Main from '../Main/Main';\nimport Movies from '../Movies/Movies';\nimport SavedMovies from '../SavedMovies/SavedMovies';\nimport Profile from '../Profile/Profile';\nimport Login from '../Login/Login';\nimport Register from '../Register/Register';\nimport Page404 from '../Page404/Page404';\nimport InfoTooltip from '../InfoTooltip/InfoTooltip';\nimport ProtectedRoute from '../ProtectedRoute/ProtectedRoute';\nimport * as tooltip from '../../utils/tooltip';\nimport * as MainApi from '../../utils/MainApi';\nimport * as MoviesApi from '../../utils/MoviesApi';\nimport './App.css';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const history = useHistory();\n  const location = useLocation();\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState({});\n  const [isInfoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const [infoToolTipInfo, setInfoToolTipInfo] = useState({});\n  const [movies, setMovies] = useState([]); // Фильмы, полученные от Api\n\n  const [savedMovies, setSavedMovies] = useState([]); // Фильмы, сохраненные пользователем\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [movieSearchResult, setMovieSearchResult] = useState([]); // ЛОКАЛЬНОЕ ХРАНИЛИЩЕ\n  // Фильмы, полученные после фильтрации\n  // localStorage.setItem('searchResults', []);\n  // Текст запроса\n\n  const searchWord = localStorage.getItem('searchWord'); // Состояние переключателя\n\n  const filterState = localStorage.getItem('filterState'); // Обработка регистрации\n\n  function handleRegister(name, email, password) {\n    MainApi.register(email, password, name).then(res => {\n      if (res.ok) {\n        history.push('/signin');\n        setInfoToolTipInfo({\n          mesage: tooltip.registrationSuccess,\n          image: tooltip.successIcon\n        });\n      } else {\n        setInfoToolTipInfo({\n          message: tooltip.registrationFail,\n          image: tooltip.successIcon\n        });\n      }\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.registrationFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      setIsInfoToolTipOpen(true);\n    });\n  } // Обработка логина\n\n\n  function handleLogin(email, password) {\n    if (!email || !password) {\n      console.log('No email or password on login; aborting.');\n      return;\n    }\n\n    MainApi.login(email, password).then(data => {\n      console.log(`In handleLogin: res data: ${data.jwt}`);\n\n      if (!data.jwt) {\n        throw new Error('Произошла ошибка (авторизации на фронте)');\n      }\n\n      localStorage.setItem('jwt', data.jwt);\n      localStorage.setItem('searchResults', []);\n      return data._id;\n    }).then(id => {\n      tokenCheck();\n      setCurrentUser({\n        _id: id\n      });\n      setIsLoggedIn(true);\n      history.push('/movies');\n      setInfoToolTipInfo({\n        message: tooltip.loginSuccess,\n        image: tooltip.successIcon\n      });\n      console.log(`33333 In getSearchResults: ${localStorage.getItem('searchResults')}`);\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.loginFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      console.log(`Before Popup open: ${isLoggedIn}`);\n      setIsInfoToolTipOpen(true);\n    });\n  } // Обработка обновления профиля\n\n\n  function handleEditProfileSubmit(name, email) {\n    MainApi.editProfile(name, email).then(data => {\n      setCurrentUser(data);\n      setInfoToolTipInfo({\n        message: tooltip.updateSuccess,\n        image: tooltip.successIcon\n      });\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.updateFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      setIsInfoToolTipOpen(true);\n    });\n  }\n\n  function handleLogOut() {\n    localStorage.removeItem('jwt');\n    setIsLoggedIn(false);\n    history.push('/signin');\n  }\n\n  function closePopups() {\n    setIsInfoToolTipOpen(false);\n  } // Добавить фильм в библиотеку сохраненных фильмов\n  // или оповестить юзера об ошибке\n\n\n  function handleSetLike(movie) {\n    MainApi.createLocalCard(movie).then(createdMovie => {\n      console.log(`Saved movie in handleSetLike: ${createdMovie}`);\n      setSavedMovies([createdMovie, ...savedMovies]);\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.saveFail,\n        image: tooltip.failIcon\n      });\n      setIsInfoToolTipOpen(true);\n    });\n  }\n\n  function handleRemoveLike(movie) {\n    MainApi.deleteLocalMovie(movie.movieId).then(() => {\n      MainApi.getSavedMovies.then(movies => {\n        setSavedMovies(movies);\n      }).catch(err => {\n        console.log(err);\n      });\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.removeFail,\n        image: tooltip.failIcon\n      });\n      setIsInfoToolTipOpen(true);\n    });\n  } // Получить фильмы с API\n  // происходит при авторизации\n\n\n  function getMovies() {\n    MoviesApi.getMovies().then(data => {\n      if (data) {\n        console.log(`MoviesApi response: raw data: ${data}`);\n        console.log(`MoviesApi response: raw data one movie: ${JSON.stringify(data[0])}`);\n        console.log(`MoviesApi response: ${JSON.stringify(data)}`);\n        const movieArray = JSON.stringify(data).split('},{');\n        console.log(`MoviesApi response: array: ${movieArray}`);\n        console.log(`MoviesApi response: array: ${typeof movieArray}`);\n        setMovies(data);\n      }\n    }).catch(err => {\n      console.log(err);\n    }).finally(() => {\n      console.log(`MoviesApi movies: ${movies}`);\n    });\n  } // Получить все сохраненные фильмы с сервера\n\n\n  function getSavedMovies() {\n    console.log(`Login State in getSavedMovies on login:${isLoggedIn}`);\n\n    if (isLoggedIn) {\n      MainApi.getSavedMovies().then(data => {\n        console.log(`MainApi.getSavedMovies result: raw data: ${data}`);\n        console.log(`MainApi.getSavedMovies result: ${JSON.stringify(data)}`);\n\n        if (data) {\n          setSavedMovies(data);\n          console.log(`Setting saved movies: ${savedMovies}`);\n        }\n      }).catch(err => {\n        console.log(err);\n      }).finally(() => {\n        console.log(`MoviesApi savedMovies: ${savedMovies}`);\n      });\n    }\n  }\n\n  function getSearchResults() {\n    // setMovieSearchResult(searchResults === null ? [] : searchResults );\n    console.log(`11111 In getSearchResults: ${movieSearchResult}`);\n  } // После отправки поскового запроса \n  // сначала отображаем прелодер, затем\n  // забираем все фильмы с api и сохраняем в переменную состояния.\n  // После сохранения фильмов фильтруем их по поисковому слову\n\n\n  function handleSearchRequest(value) {\n    assembleMoviesList(value);\n  } // Функция по фильтрации массивов с фильмами по ключевому слову\n\n\n  function filterBySearchWord(list, word) {\n    // console.log(`In filterBySearchWord: movies: ${list}`);\n    // console.log(`In filterBySearchWord: ${typeof list}`);\n    // console.log(`In filterBySearchWord: word ${word}`);\n    const array = list;\n    console.log(`In filterBySearchWord: parsed array: ${array}`);\n\n    if (array.length > 0) {\n      return array.filter(movie => movie.nameRU.toLowerCase().includes(word.toLowerCase()));\n    } else {\n      return [];\n    }\n  } // При отображении фильмов в блоке результатов\n  // фильмы, ранее сохраненные пользователем берутся с сервера\n  // (так как только на них будет ярлык сохраненных));\n\n\n  function assembleMoviesList(word) {\n    // Проверяем все фильмы\n    // Проверяем сохраненные фильмы\n    // const allFilteredMovies = JSON.parse(JSON.stringify(filterBySearchWord(movies, word)));\n    // const allSavedMovies = JSON.parse(JSON.stringify(filterBySearchWord(savedMovies, word)));\n    console.log(`In assembleMoviesList: movies: ${movies}`);\n    console.log(`In assembleMoviesList: savedMovies: ${savedMovies}`); // const parsedMovies = JSON.parse(movies);\n    // const parsedSavedMovies = JSON.parse(savedMovies);\n    // console.log(`In assembleMoviesList: parsedMovies: ${parsedMovies}`);\n    // console.log(`In assembleMoviesList: parsedSavedMovies: ${parsedSavedMovies}`);\n\n    const allFilteredMovies = filterBySearchWord(movies, word);\n    const allSavedMovies = filterBySearchWord(savedMovies, word);\n    console.log(`In assembleMoviesList: allFilteredMovies: ${allFilteredMovies}`);\n    console.log(`In assembleMoviesList: allSavedMovies: ${allSavedMovies}`); // Сравниваем два массива,\n    // повторяющиеся фильмы берем с серверной стороны\n\n    const movieList = allFilteredMovies.map(movie => {\n      const savedMovie = allSavedMovies.find(savedM => savedM.movieId === movie.id);\n      return savedMovie !== null && savedMovie !== void 0 ? savedMovie : movie;\n    });\n\n    if (movieList) {\n      console.log(`In assembleMoviesList: movieList: ${movieList}`);\n    } // Если результатов нет - записываем в переменную пустой массив\n\n\n    if (movieList !== null && movieList.length !== 0) {\n      localStorage.setItem('searchResults', movieList); /// try to turn into array [movielist]\n      // setMovieSearchResult(localStorage.getItem('searchResults'));\n\n      setMovieSearchResult(movieList);\n    } else {\n      localStorage.setItem('searchResults', []); // setMovieSearchResult(localStorage.getItem('searchResults'));\n\n      setMovieSearchResult([]);\n    }\n\n    console.log(`assembleMoviesList: searchresult in local storage: ${localStorage.getItem('searchResults')}`);\n    console.log(`assembleMoviesList: movieSearchResult: ${movieSearchResult}`);\n  } // Проверяем наличие токена в локальном хранилище\n  // если токен присутствует - \n  // меняем состояние логина и\n  // забираем данные о юзере с сервера и сохранем в переменную состояния. \n\n\n  function tokenCheck() {\n    const jwt = localStorage.getItem('jwt');\n    console.log(`Token in tokenCheck: ${jwt}`);\n    console.log(`22222 In getSearchResults: ${movieSearchResult}`);\n\n    if (jwt) {\n      MainApi.getContent(jwt).then(user => {\n        if (user) {\n          setIsLoggedIn(true);\n          setCurrentUser(user); // setMovieSearchResult(searchResults === null ? [] : searchResults );\n\n          location.pathname === '/signin' && history.push('/movies');\n          console.log(`In tokenCheck: getContent currentUSer: ${currentUser}`);\n          console.log(`In tokenCheck: getContent response: ${JSON.stringify(user)}`);\n        } else {\n          localStorage.removeItem('jwt');\n          setIsLoggedIn(false);\n        }\n      }).catch(err => {\n        localStorage.removeItem('jwt');\n      });\n    } else {\n      setIsLoggedIn(false);\n    }\n  } // Получаем все фильмы с API и сохраненные юзером фильмы при авторизации\n\n\n  useEffect(() => {\n    console.log(`Fetching movies...`);\n\n    if (isLoggedIn) {\n      getMovies();\n      getSavedMovies();\n    }\n  }, [isLoggedIn]); // Проверяем токен при передвижению по сайту\n\n  useEffect(() => {\n    tokenCheck();\n    getSearchResults();\n  }, [history]);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app\",\n      children: [/*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          children: /*#__PURE__*/_jsxDEV(Main, {\n            isLoggedIn: isLoggedIn\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"/movies\",\n          component: Movies,\n          movies: movies,\n          movieSearchResult: movieSearchResult,\n          searchWord: searchWord,\n          onLike: handleSetLike,\n          onDislike: handleRemoveLike,\n          onSearch: handleSearchRequest,\n          isLoggedIn: isLoggedIn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"saved-movies\",\n          component: SavedMovies,\n          savedMovies: savedMovies,\n          isLoggedIn: isLoggedIn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"/profile\",\n          component: Profile,\n          onSubmit: handleEditProfileSubmit,\n          onLogOut: handleLogOut,\n          isLoggedIn: isLoggedIn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/signin\",\n          children: /*#__PURE__*/_jsxDEV(Login, {\n            handleLogin: handleLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/signup\",\n          children: /*#__PURE__*/_jsxDEV(Register, {\n            handleRegister: handleRegister\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          children: /*#__PURE__*/_jsxDEV(Page404, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InfoTooltip, {\n        isOpen: isInfoToolTipOpen,\n        onClose: closePopups,\n        info: infoToolTipInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 366,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"8G1GUIE6WC3Io3mGGWWW/pFmAQA=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = App;\nexport default App; // Поиск фильмов\n// Нажатие на кнопку поиска\n// получение всех фильмов с MoviesApi\n// сохранение фильмов в переменную состояние movies\n// фильтрация полученных фильмов по поисковому слову\n// сохранение отфильтрованного массива на локальном сервере\n// передача отфильтрованного массива на отрисовку в MoviesList\n// \n// Проверить в следующий раз:\n// Теперь у нас есть результаты поска и поисковое слово, \n// сохраненное на локальном сервере.\n// Ружно передать отфильтрованные фильмы на отрисовку в \n// MoviesList:\n//\n// Фильтруем фильмы\n// Переаем их MoviesList\n// \n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","Route","Switch","useHistory","useLocation","Main","Movies","SavedMovies","Profile","Login","Register","Page404","InfoTooltip","ProtectedRoute","tooltip","MainApi","MoviesApi","CurrentUserContext","App","history","location","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","isInfoToolTipOpen","setIsInfoToolTipOpen","infoToolTipInfo","setInfoToolTipInfo","movies","setMovies","savedMovies","setSavedMovies","isLoading","setIsLoading","movieSearchResult","setMovieSearchResult","searchWord","localStorage","getItem","filterState","handleRegister","name","email","password","register","then","res","ok","push","mesage","registrationSuccess","image","successIcon","message","registrationFail","catch","err","console","log","failIcon","finally","handleLogin","login","data","jwt","Error","setItem","_id","id","tokenCheck","loginSuccess","loginFail","handleEditProfileSubmit","editProfile","updateSuccess","updateFail","handleLogOut","removeItem","closePopups","handleSetLike","movie","createLocalCard","createdMovie","saveFail","handleRemoveLike","deleteLocalMovie","movieId","getSavedMovies","removeFail","getMovies","JSON","stringify","movieArray","split","getSearchResults","handleSearchRequest","value","assembleMoviesList","filterBySearchWord","list","word","array","length","filter","nameRU","toLowerCase","includes","allFilteredMovies","allSavedMovies","movieList","map","savedMovie","find","savedM","getContent","user","pathname"],"sources":["/Users/localmoyashi/dev/movies-explorer-frontend/src/components/App/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Route, Switch, useHistory, useLocation } from 'react-router-dom';\nimport Main from '../Main/Main';\nimport Movies from '../Movies/Movies';\nimport SavedMovies from '../SavedMovies/SavedMovies';\nimport Profile from '../Profile/Profile';\nimport Login from '../Login/Login';\nimport Register from '../Register/Register';\nimport Page404 from '../Page404/Page404';\nimport InfoTooltip from '../InfoTooltip/InfoTooltip';\nimport ProtectedRoute from '../ProtectedRoute/ProtectedRoute';\nimport * as tooltip from '../../utils/tooltip';\nimport * as MainApi from '../../utils/MainApi';\nimport * as MoviesApi from '../../utils/MoviesApi';\nimport './App.css';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\n\nfunction App() {\n\n  const history = useHistory();\n  const location = useLocation();\n\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState({});\n  const [isInfoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const [infoToolTipInfo, setInfoToolTipInfo] = useState({});\n  const [movies, setMovies] = useState([]); // Фильмы, полученные от Api\n  const [savedMovies, setSavedMovies] = useState([]); // Фильмы, сохраненные пользователем\n  const [isLoading, setIsLoading] = useState(false);\n  const [movieSearchResult, setMovieSearchResult] = useState([]);\n\n  // ЛОКАЛЬНОЕ ХРАНИЛИЩЕ\n\n  // Фильмы, полученные после фильтрации\n  // localStorage.setItem('searchResults', []);\n  // Текст запроса\n  const searchWord = localStorage.getItem('searchWord');\n  // Состояние переключателя\n  const filterState = localStorage.getItem('filterState');\n\n  // Обработка регистрации\n\n  function handleRegister (name, email, password) {\n    MainApi.register(email, password, name)\n      .then((res) => {\n        if (res.ok) {\n          history.push('/signin');\n          setInfoToolTipInfo({\n            mesage: tooltip.registrationSuccess,\n            image: tooltip.successIcon\n          });\n        } else {\n          setInfoToolTipInfo({\n            message: tooltip.registrationFail,\n            image: tooltip.successIcon\n          })\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.registrationFail,\n          image: tooltip.failIcon\n        });\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true);\n      })\n  }\n  \n  // Обработка логина\n\n  function handleLogin (email, password) {\n    if (!email || !password) {\n      console.log('No email or password on login; aborting.');\n      return;\n    }\n    \n    MainApi.login(email, password)\n      .then((data) => {\n        console.log(`In handleLogin: res data: ${data.jwt}`);\n        if(!data.jwt) {\n          throw new Error('Произошла ошибка (авторизации на фронте)');\n        }\n        localStorage.setItem('jwt', data.jwt);\n        localStorage.setItem('searchResults', []);\n        return data._id;\n      })\n      .then((id) => {\n        tokenCheck();\n        setCurrentUser({\n          _id: id,\n        });\n        setIsLoggedIn(true);\n        history.push('/movies');\n        setInfoToolTipInfo({\n          message: tooltip.loginSuccess,\n          image: tooltip.successIcon\n        })\n        console.log(`33333 In getSearchResults: ${localStorage.getItem('searchResults')}`);\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.loginFail,\n          image: tooltip.failIcon\n        });\n      })\n      .finally(() => {\n        console.log(`Before Popup open: ${isLoggedIn}`)\n        setIsInfoToolTipOpen(true);\n      });\n  }\n\n  // Обработка обновления профиля\n\n  function handleEditProfileSubmit (name, email) {\n    MainApi.editProfile(name, email)\n      .then((data) => {\n        setCurrentUser(data);\n        setInfoToolTipInfo({\n          message: tooltip.updateSuccess,\n          image: tooltip.successIcon\n        })\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.updateFail,\n          image: tooltip.failIcon\n        })\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true)\n      });\n  }\n\n  function handleLogOut () {\n    localStorage.removeItem('jwt');\n    setIsLoggedIn(false);\n    history.push('/signin');\n  }\n\n  function closePopups () {\n    setIsInfoToolTipOpen(false);\n  }\n\n  // Добавить фильм в библиотеку сохраненных фильмов\n  // или оповестить юзера об ошибке\n\n  function handleSetLike (movie) {\n    MainApi.createLocalCard(movie)\n      .then((createdMovie) => {\n        console.log(`Saved movie in handleSetLike: ${createdMovie}`);\n        setSavedMovies([createdMovie, ...savedMovies])\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.saveFail,\n          image: tooltip.failIcon\n        });\n        setIsInfoToolTipOpen(true);\n      })\n  }\n\n  function handleRemoveLike (movie) {\n    MainApi.deleteLocalMovie(movie.movieId)\n      .then(() => {\n        MainApi.getSavedMovies\n          .then((movies) => {\n            setSavedMovies(movies);\n          })\n          .catch((err) => {\n            console.log(err);\n          })\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.removeFail,\n          image: tooltip.failIcon\n        });\n        setIsInfoToolTipOpen(true);\n      })\n  }\n\n  // Получить фильмы с API\n  // происходит при авторизации\n\n  function getMovies() {\n    MoviesApi.getMovies()\n    .then((data) => {\n      if(data) {\n        console.log(`MoviesApi response: raw data: ${data}`);\n        console.log(`MoviesApi response: raw data one movie: ${JSON.stringify(data[0])}`);\n        console.log(`MoviesApi response: ${JSON.stringify(data)}`);\n        const movieArray = JSON.stringify(data).split('},{');\n        console.log(`MoviesApi response: array: ${movieArray}`);\n        console.log(`MoviesApi response: array: ${typeof movieArray}`);\n        setMovies(data);\n      } \n    })\n    .catch((err) => {\n      console.log(err);\n    })\n    .finally(() => {\n      console.log(`MoviesApi movies: ${movies}`);\n    })\n  }\n\n  // Получить все сохраненные фильмы с сервера\n  \n  function getSavedMovies() {\n    console.log(`Login State in getSavedMovies on login:${isLoggedIn}`);\n    if(isLoggedIn) {\n      MainApi.getSavedMovies()\n      .then((data) => {\n        console.log(`MainApi.getSavedMovies result: raw data: ${data}`);\n        console.log(`MainApi.getSavedMovies result: ${JSON.stringify(data)}`);\n        if(data) {\n          setSavedMovies(data);\n          console.log(`Setting saved movies: ${savedMovies}`);\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n      .finally(() => {\n        console.log(`MoviesApi savedMovies: ${savedMovies}`);\n      })\n    }\n  }\n\n  function getSearchResults() {\n    // setMovieSearchResult(searchResults === null ? [] : searchResults );\n    console.log(`11111 In getSearchResults: ${movieSearchResult}`);\n  }\n\n  // После отправки поскового запроса \n  // сначала отображаем прелодер, затем\n  // забираем все фильмы с api и сохраняем в переменную состояния.\n  // После сохранения фильмов фильтруем их по поисковому слову\n\n  function handleSearchRequest(value) {\n    assembleMoviesList(value)\n  }\n\n  // Функция по фильтрации массивов с фильмами по ключевому слову\n\n  function filterBySearchWord(list, word) {\n    // console.log(`In filterBySearchWord: movies: ${list}`);\n    // console.log(`In filterBySearchWord: ${typeof list}`);\n    // console.log(`In filterBySearchWord: word ${word}`);\n    const array = list;\n    console.log(`In filterBySearchWord: parsed array: ${array}`);\n    \n    if (array.length > 0) {\n      return array.filter((movie) => movie.nameRU.toLowerCase().includes(word.toLowerCase()));\n    } else {\n      return [];\n    }\n  }\n\n  // При отображении фильмов в блоке результатов\n  // фильмы, ранее сохраненные пользователем берутся с сервера\n  // (так как только на них будет ярлык сохраненных));\n\n  function assembleMoviesList(word) {\n    // Проверяем все фильмы\n    // Проверяем сохраненные фильмы\n    // const allFilteredMovies = JSON.parse(JSON.stringify(filterBySearchWord(movies, word)));\n    // const allSavedMovies = JSON.parse(JSON.stringify(filterBySearchWord(savedMovies, word)));\n    console.log(`In assembleMoviesList: movies: ${movies}`);\n    console.log(`In assembleMoviesList: savedMovies: ${savedMovies}`);\n    // const parsedMovies = JSON.parse(movies);\n    // const parsedSavedMovies = JSON.parse(savedMovies);\n\n    // console.log(`In assembleMoviesList: parsedMovies: ${parsedMovies}`);\n    // console.log(`In assembleMoviesList: parsedSavedMovies: ${parsedSavedMovies}`);\n\n    const allFilteredMovies = filterBySearchWord(movies, word);\n    const allSavedMovies = filterBySearchWord(savedMovies, word);\n\n    console.log(`In assembleMoviesList: allFilteredMovies: ${allFilteredMovies}`);\n    console.log(`In assembleMoviesList: allSavedMovies: ${allSavedMovies}`);\n\n    // Сравниваем два массива,\n    // повторяющиеся фильмы берем с серверной стороны\n    const movieList = allFilteredMovies.map((movie) => {\n      const savedMovie = allSavedMovies.find((savedM) => savedM.movieId === movie.id);\n      return savedMovie ?? movie;\n    })\n\n    if(movieList) {\n      console.log(`In assembleMoviesList: movieList: ${movieList}`);\n    }\n\n    // Если результатов нет - записываем в переменную пустой массив\n    if(movieList !== null && movieList.length !== 0) {\n      localStorage.setItem('searchResults', movieList); /// try to turn into array [movielist]\n      // setMovieSearchResult(localStorage.getItem('searchResults'));\n      setMovieSearchResult(movieList);\n    } else {\n      localStorage.setItem('searchResults', []);\n      // setMovieSearchResult(localStorage.getItem('searchResults'));\n      setMovieSearchResult([]);\n    }\n    \n    console.log(`assembleMoviesList: searchresult in local storage: ${localStorage.getItem('searchResults')}`);\n    console.log(`assembleMoviesList: movieSearchResult: ${movieSearchResult}`);\n  }\n\n  // Проверяем наличие токена в локальном хранилище\n  // если токен присутствует - \n  // меняем состояние логина и\n  // забираем данные о юзере с сервера и сохранем в переменную состояния. \n\n  function tokenCheck () {\n    const jwt = localStorage.getItem('jwt');\n\n    console.log(`Token in tokenCheck: ${jwt}`);\n    console.log(`22222 In getSearchResults: ${movieSearchResult}`);\n\n    if (jwt) {\n      MainApi.getContent(jwt)\n        .then((user) => {\n          if (user) {\n            setIsLoggedIn(true);\n            setCurrentUser(user);\n            // setMovieSearchResult(searchResults === null ? [] : searchResults );\n            location.pathname === '/signin' && history.push('/movies');\n\n            console.log(`In tokenCheck: getContent currentUSer: ${currentUser}`);\n            console.log(`In tokenCheck: getContent response: ${JSON.stringify(user)}`);\n          } else {\n            localStorage.removeItem('jwt');\n            setIsLoggedIn(false);\n          }\n        })\n        .catch((err) => {\n          localStorage.removeItem('jwt');\n        })\n    } else {\n      setIsLoggedIn(false);\n    }\n  }\n  // Получаем все фильмы с API и сохраненные юзером фильмы при авторизации\n  useEffect(() => {\n    console.log(`Fetching movies...`);\n\n    if(isLoggedIn) {\n      getMovies();\n      getSavedMovies();\n    }    \n  }, [isLoggedIn])\n\n  // Проверяем токен при передвижению по сайту\n  useEffect(() => {\n    tokenCheck();\n    getSearchResults();\n  }, [history]);\n\n  \n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"app\">\n        <Switch>\n          <Route exact path=\"/\">\n            <Main\n              isLoggedIn={isLoggedIn} />\n          </Route>\n\n          <ProtectedRoute\n            path=\"/movies\"\n            component={Movies}\n            movies={movies}\n            movieSearchResult={movieSearchResult}\n            searchWord={searchWord}\n            onLike={handleSetLike}\n            onDislike={handleRemoveLike}\n            onSearch={handleSearchRequest}\n            isLoggedIn={isLoggedIn} />\n\n          <ProtectedRoute\n            path=\"saved-movies\"\n            component={SavedMovies}\n            savedMovies={savedMovies}\n            isLoggedIn={isLoggedIn} />\n\n          <ProtectedRoute\n            path=\"/profile\"\n            component={Profile}\n            onSubmit={handleEditProfileSubmit}\n            onLogOut={handleLogOut}\n            isLoggedIn={isLoggedIn} />\n\n          <Route path=\"/signin\">\n            <Login\n              handleLogin={handleLogin} />\n          </Route>\n\n          <Route path=\"/signup\">\n            <Register\n              handleRegister={handleRegister} />\n          </Route>\n\n          <Route path=\"*\">\n            <Page404 />\n          </Route>\n        </Switch>\n\n        <InfoTooltip\n          isOpen={isInfoToolTipOpen}\n          onClose={closePopups}\n          info={infoToolTipInfo} />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n\n// Поиск фильмов\n// Нажатие на кнопку поиска\n// получение всех фильмов с MoviesApi\n// сохранение фильмов в переменную состояние movies\n// фильтрация полученных фильмов по поисковому слову\n// сохранение отфильтрованного массива на локальном сервере\n// передача отфильтрованного массива на отрисовку в MoviesList\n// \n// Проверить в следующий раз:\n// Теперь у нас есть результаты поска и поисковое слово, \n// сохраненное на локальном сервере.\n// Ружно передать отфильтрованные фильмы на отрисовку в \n// MoviesList:\n//\n// Фильтруем фильмы\n// Переаем их MoviesList\n// "],"mappings":"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"},"metadata":{},"sourceType":"module"}