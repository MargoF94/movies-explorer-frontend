{"ast":null,"code":"var _jsxFileName = \"/Users/localmoyashi/dev/movies-explorer-frontend/src/components/App/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { Route, Switch, useHistory, useLocation } from 'react-router-dom';\nimport Main from '../Main/Main';\nimport Movies from '../Movies/Movies';\nimport SavedMovies from '../SavedMovies/SavedMovies';\nimport Profile from '../Profile/Profile';\nimport Login from '../Login/Login';\nimport Register from '../Register/Register';\nimport Page404 from '../Page404/Page404';\nimport InfoTooltip from '../InfoTooltip/InfoTooltip';\nimport ProtectedRoute from '../ProtectedRoute/ProtectedRoute';\nimport * as tooltip from '../../utils/tooltip';\nimport * as MainApi from '../../utils/MainApi';\nimport * as MoviesApi from '../../utils/MoviesApi';\nimport './App.css';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const history = useHistory();\n  const location = useLocation();\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState({});\n  const [isInfoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const [infoToolTipInfo, setInfoToolTipInfo] = useState({});\n  const [movies, setMovies] = useState([]); // Фильмы, полученные от Api\n\n  const [savedMovies, setSavedMovies] = useState([]); // Фильмы, сохраненные пользователем\n\n  const [movieSearchResult, setMovieSearchResult] = useState([]);\n  const [savedMovieSearchResult, setSavedMovieSearchResult] = useState([]);\n  const [isShortMovieChecked, setIsShortMovieChecked] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isNoResults, setIsNoResuls] = useState(false);\n  const [areSavedMoviesFiltered, setAreSavedMoviesFiltered] = useState(false); // ЛОКАЛЬНОЕ ХРАНИЛИЩЕ\n  // Текст запроса\n\n  const searchWordLocalStorage = localStorage.getItem('searchWord'); // Обработка регистрации\n\n  function handleRegister(email, password, name) {\n    MainApi.register(email, password, name).then(res => {\n      if (res.ok) {\n        // history.push('/movies');\n        setInfoToolTipInfo({\n          message: tooltip.registrationSuccess,\n          image: tooltip.successIcon\n        });\n        handleLogin(email, password);\n      } else {\n        setInfoToolTipInfo({\n          message: tooltip.registrationFail,\n          image: tooltip.successIcon\n        });\n      }\n    }) // .then(() => {\n    //   handleLogin(email, password);\n    // })\n    .catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.registrationFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      setIsInfoToolTipOpen(true);\n    });\n  } // Обработка логина\n\n\n  function handleLogin(email, password) {\n    if (!email || !password) {\n      console.log('No email or password on login; aborting.');\n      console.log(`Email: ${email}`);\n      console.log(`Password: ${password}`);\n      return;\n    }\n\n    MainApi.login(email, password).then(data => {\n      if (!data.jwt) {\n        throw new Error('Произошла ошибка (авторизации на фронте)');\n      }\n\n      setIsLoggedIn(true);\n      localStorage.setItem('jwt', data.jwt);\n      localStorage.setItem('searchResults', []);\n      localStorage.setItem('filterState', false);\n      localStorage.setItem('filterStateInSaved', false);\n      localStorage.setItem('searchWord', '');\n      localStorage.setItem('searchWordInSaved', '');\n      return data._id;\n    }).then(id => {\n      tokenCheck();\n      setCurrentUser({\n        _id: id\n      });\n      setInfoToolTipInfo({\n        message: tooltip.loginSuccess,\n        image: tooltip.successIcon\n      });\n      history.push('/movies');\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.loginFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      console.log(`Before Popup open: ${isLoggedIn}`);\n      setIsInfoToolTipOpen(true);\n    });\n  } // Обработка обновления профиля\n\n\n  function handleEditProfileSubmit(name, email) {\n    MainApi.editProfile(name, email).then(data => {\n      setCurrentUser(data);\n      setInfoToolTipInfo({\n        message: tooltip.updateSuccess,\n        image: tooltip.successIcon\n      });\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.updateFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      setIsInfoToolTipOpen(true);\n    });\n  }\n\n  function handleLogOut() {\n    localStorage.removeItem('jwt');\n    localStorage.removeItem('searcResults');\n    localStorage.removeItem('searchWord');\n    localStorage.removeItem('searchWordInSaved');\n    localStorage.removeItem('filterState');\n    localStorage.removeItem('filterStateInSaved');\n    setIsLoggedIn(false);\n    setCurrentUser({});\n    setMovies([]);\n    setSavedMovies([]);\n    history.push('/');\n  }\n\n  function closePopups() {\n    setIsInfoToolTipOpen(false);\n  } // Добавить фильм в библиотеку сохраненных фильмов\n  // или оповестить юзера об ошибке\n\n\n  function handleSetLike(movie) {\n    const isSaved = savedMovies.find(savedMovie => savedMovie.movieId === movie.movieId);\n\n    if (isSaved === undefined) {\n      MainApi.createLocalCard(movie).then(data => {\n        console.log(data);\n        const createdMovie = data.movie;\n        setInfoToolTipInfo({\n          message: tooltip.saveSuccess,\n          image: tooltip.successIcon\n        });\n        setSavedMovies([createdMovie, ...savedMovies]);\n      }).catch(err => {\n        setInfoToolTipInfo({\n          message: tooltip.saveFail,\n          image: tooltip.failIcon\n        });\n        setIsInfoToolTipOpen(true);\n      }).finally(() => {\n        setIsInfoToolTipOpen(true);\n      });\n    } else {\n      setInfoToolTipInfo({\n        message: tooltip.saveFailRepeat,\n        image: tooltip.failIcon\n      });\n      setIsInfoToolTipOpen(true);\n    }\n  }\n\n  function handleRemoveLike(movie) {\n    // console.log(`In App handleRemoveLike movie: id: ${movie.movieId}`);\n    MainApi.deleteLocalMovie(movie.movieId).then(() => {\n      setSavedMovies(savedMovies => savedMovies.filter(m => m.movieId !== movie.movieId));\n      setInfoToolTipInfo({\n        message: tooltip.removeSuccess,\n        image: tooltip.successIcon\n      });\n    }).catch(err => {\n      console.log(err);\n      setInfoToolTipInfo({\n        message: tooltip.removeFail,\n        image: tooltip.failIcon\n      });\n    }).finally(() => {\n      setIsInfoToolTipOpen(true);\n    });\n  } // Переключатель состояния фильтра короткометражек\n  // Переписывает значение фильтра на локальном диске и \n  // переменной состояния\n\n\n  function toggleCheckBox() {\n    const filter = JSON.parse(localStorage.getItem('filterState'));\n    localStorage.setItem('filterState', !filter);\n    setIsShortMovieChecked(!filter); // console.log(`FILTER STATE (LOCAL) ON TOGGLE IS ${localStorage.getItem('filterState')}`);\n    // console.log(`FILTER STATE (STATE) ON TOGGLE IS ${isShortMovieChecked}`);\n  } // Функция по фильтрации массивов с фильмами по ключевому слову\n  // и длительности\n\n\n  function filterBySearchWord(list, word, isShortOn) {\n    if (list.length > 0) {\n      if (isShortOn === true) {\n        return list.filter(movie => movie.nameRU.toLowerCase().includes(word.toLowerCase()) && movie.duration < 40);\n      } else {\n        return list.filter(movie => movie.nameRU.toLowerCase().includes(word.toLowerCase()));\n      }\n    } else {\n      return [];\n    }\n  }\n\n  function handleSearchRequest(word, filterState) {\n    setIsLoading(true); // console.log(`IN SEARCH HANDLER: ${JSON.parse(localStorage.getItem('filterState'))}`);\n\n    setTimeout(() => {\n      const movieList = filterBySearchWord(movies, word, filterState);\n\n      if (movieList !== null && movieList.length !== 0) {\n        localStorage.setItem('searchResults', JSON.stringify(movieList));\n        setIsNoResuls(false);\n      } else {\n        localStorage.setItem('searchResults', []);\n        setIsNoResuls(true);\n      }\n\n      localStorage.setItem('filterState', filterState);\n      localStorage.setItem('searchWord', word);\n      setMovieSearchResult(movieList);\n      setIsLoading(false);\n    }, 1000);\n  }\n\n  function handleSearchRequestInSaved(word, filterState) {\n    setIsLoading(true);\n    setTimeout(() => {\n      console.log(`In filterinf saved movies: ${filterState}`);\n      const movieList = filterBySearchWord(savedMovies, word, filterState);\n\n      if (movieList !== null && movieList.length !== 0) {\n        setIsNoResuls(false);\n      } else {\n        setIsNoResuls(true);\n      }\n\n      localStorage.setItem('filterStateInSaved', filterState);\n      setSavedMovieSearchResult(movieList);\n      setAreSavedMoviesFiltered(true);\n      setIsLoading(false);\n    }, 1000);\n  }\n\n  function resetAreSavedMoviesFiltered() {\n    setAreSavedMoviesFiltered(false);\n  } // Проверяем наличие токена в локальном хранилище\n  // если токен присутствует - \n  // меняем состояние логина и\n  // забираем данные о юзере с сервера и сохранем в переменную состояния. \n\n\n  function tokenCheck() {\n    const jwt = localStorage.getItem('jwt'); // console.log('ACTION 1 (tokenCheck)');\n    // console.log(`Token in tokenCheck: ${jwt}`);\n    // console.log(`777777777 Token in tokenCheck: idLoggedIn ${isLoggedIn}`);\n    // console.log(`22222 In getSearchResults: ${movieSearchResult}`);\n\n    if (jwt) {\n      MainApi.getContent(jwt).then(user => {\n        if (user) {\n          setCurrentUser(user);\n          setIsLoggedIn(true);\n          setMovieSearchResult(getSearchResults);\n          setIsShortMovieChecked(JSON.parse(localStorage.getItem('filterState'))); // console.log(`isShortMovieChecked ${isShortMovieChecked}`)\n\n          if (location.pathname === '/signin') {\n            history.push('/movies');\n          } else if (location.pathname === '/signup') {\n            history.push('/movies');\n          } else {\n            history.push(location.pathname);\n          } // console.log(`Token in tokenCheck: idLoggedIn ${isLoggedIn}`);\n          // console.log(`In tokenCheck: getContent currentUSer: ${currentUser}`);\n          // console.log(`In tokenCheck: getContent response: ${JSON.stringify(user)}`);\n\n        } else {\n          localStorage.removeItem('jwt');\n        }\n      }).catch(err => {\n        console.log(err);\n        localStorage.removeItem('jwt');\n      });\n    }\n  } // Извлекает и записывает данные с локального хранилища в переменную состояния\n\n\n  function getSearchResults() {\n    return localStorage.getItem('searchResults').length > 0 ? JSON.parse(localStorage.getItem('searchResults')) : [];\n  } // Если пользователь залогинен\n  // получаем все фильмы с API и сохраненные юзером фильмы\n\n\n  useEffect(() => {\n    if (isLoggedIn) {\n      console.log(`Fetching movies...`);\n      console.log('ACTION 2 (about to fetch movies)');\n      Promise.all([MoviesApi.getMovies(), MainApi.getSavedMovies()]).then(_ref => {\n        let [allMovies, userSavedMovies] = _ref;\n        // console.log('ACTION 3 (about to set movies and savedMovies)');\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${allMovies.length}`);\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${JSON.stringify(allMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${Array.isArray(allMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${userSavedMovies.length}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${JSON.stringify(userSavedMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${Array.isArray(userSavedMovies)}`);\n        setMovies(allMovies);\n\n        if (userSavedMovies) {\n          const filteredMovies = userSavedMovies.filter(m => m.owner === currentUser._id);\n          setSavedMovies(filteredMovies !== undefined ? filteredMovies : []); // console.log(`In MainApi.getSavedMovies: savedMovies: ${savedMovies}`);\n        } else {\n          setSavedMovies([]);\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }, [isLoggedIn]); // Проверяем токен при передвижению по сайту\n  // Перезаписываем отфильтрованные фильмы в переменную состояния\n  // из локального хранилища\n\n  useEffect(() => {\n    tokenCheck();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app\",\n      children: [/*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/\",\n          children: /*#__PURE__*/_jsxDEV(Main, {\n            isLoggedIn: isLoggedIn\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"/movies\",\n          component: Movies,\n          movies: movieSearchResult,\n          savedMovies: savedMovies,\n          searchWord: searchWordLocalStorage,\n          handleSetLike: handleSetLike,\n          handleRemoveLike: handleRemoveLike,\n          onSearch: handleSearchRequest,\n          handleCheckboxToggle: toggleCheckBox,\n          isLoggedIn: isLoggedIn,\n          isShortMovieChecked: isShortMovieChecked,\n          isNoResults: isNoResults,\n          isLoading: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"/saved-movies\",\n          component: SavedMovies,\n          movies: areSavedMoviesFiltered ? savedMovieSearchResult : savedMovies,\n          savedMovies: savedMovies,\n          savedMovieSearchResult: savedMovieSearchResult,\n          areSavedMoviesFiltered: areSavedMoviesFiltered,\n          handleRemoveLike: handleRemoveLike,\n          onSearch: handleSearchRequest,\n          onSavedSearch: handleSearchRequestInSaved,\n          handleCheckboxToggle: toggleCheckBox,\n          isLoggedIn: isLoggedIn,\n          isShortMovieChecked: isShortMovieChecked,\n          isNoResults: isNoResults,\n          resetAreSavedMoviesFiltered: resetAreSavedMoviesFiltered\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n          path: \"/profile\",\n          component: Profile,\n          onSubmit: handleEditProfileSubmit,\n          onLogOut: handleLogOut,\n          isLoggedIn: isLoggedIn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/signin\",\n          children: /*#__PURE__*/_jsxDEV(Login, {\n            handleLogin: handleLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/signup\",\n          children: /*#__PURE__*/_jsxDEV(Register, {\n            handleRegister: handleRegister\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          children: /*#__PURE__*/_jsxDEV(Page404, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InfoTooltip, {\n        isOpen: isInfoToolTipOpen,\n        onClose: closePopups,\n        info: infoToolTipInfo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 396,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"WqxIxqdEcQS3C4TM0Hn+JXsrWr0=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","Route","Switch","useHistory","useLocation","Main","Movies","SavedMovies","Profile","Login","Register","Page404","InfoTooltip","ProtectedRoute","tooltip","MainApi","MoviesApi","CurrentUserContext","App","history","location","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","isInfoToolTipOpen","setIsInfoToolTipOpen","infoToolTipInfo","setInfoToolTipInfo","movies","setMovies","savedMovies","setSavedMovies","movieSearchResult","setMovieSearchResult","savedMovieSearchResult","setSavedMovieSearchResult","isShortMovieChecked","setIsShortMovieChecked","isLoading","setIsLoading","isNoResults","setIsNoResuls","areSavedMoviesFiltered","setAreSavedMoviesFiltered","searchWordLocalStorage","localStorage","getItem","handleRegister","email","password","name","register","then","res","ok","message","registrationSuccess","image","successIcon","handleLogin","registrationFail","catch","err","console","log","failIcon","finally","login","data","jwt","Error","setItem","_id","id","tokenCheck","loginSuccess","push","loginFail","handleEditProfileSubmit","editProfile","updateSuccess","updateFail","handleLogOut","removeItem","closePopups","handleSetLike","movie","isSaved","find","savedMovie","movieId","undefined","createLocalCard","createdMovie","saveSuccess","saveFail","saveFailRepeat","handleRemoveLike","deleteLocalMovie","filter","m","removeSuccess","removeFail","toggleCheckBox","JSON","parse","filterBySearchWord","list","word","isShortOn","length","nameRU","toLowerCase","includes","duration","handleSearchRequest","filterState","setTimeout","movieList","stringify","handleSearchRequestInSaved","resetAreSavedMoviesFiltered","getContent","user","getSearchResults","pathname","Promise","all","getMovies","getSavedMovies","allMovies","userSavedMovies","filteredMovies","owner"],"sources":["/Users/localmoyashi/dev/movies-explorer-frontend/src/components/App/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Route, Switch, useHistory, useLocation } from 'react-router-dom';\nimport Main from '../Main/Main';\nimport Movies from '../Movies/Movies';\nimport SavedMovies from '../SavedMovies/SavedMovies';\nimport Profile from '../Profile/Profile';\nimport Login from '../Login/Login';\nimport Register from '../Register/Register';\nimport Page404 from '../Page404/Page404';\nimport InfoTooltip from '../InfoTooltip/InfoTooltip';\nimport ProtectedRoute from '../ProtectedRoute/ProtectedRoute';\nimport * as tooltip from '../../utils/tooltip';\nimport * as MainApi from '../../utils/MainApi';\nimport * as MoviesApi from '../../utils/MoviesApi';\nimport './App.css';\nimport { CurrentUserContext } from '../../contexts/CurrentUserContext';\n\nfunction App() {\n\n  const history = useHistory();\n  const location = useLocation();\n\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [currentUser, setCurrentUser] = useState({});\n  const [isInfoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const [infoToolTipInfo, setInfoToolTipInfo] = useState({});\n  const [movies, setMovies] = useState([]); // Фильмы, полученные от Api\n  const [savedMovies, setSavedMovies] = useState([]); // Фильмы, сохраненные пользователем\n  const [movieSearchResult, setMovieSearchResult] = useState([]);\n  const [savedMovieSearchResult, setSavedMovieSearchResult] = useState([]);\n  const [isShortMovieChecked, setIsShortMovieChecked] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isNoResults, setIsNoResuls] = useState(false);\n  const [areSavedMoviesFiltered, setAreSavedMoviesFiltered] = useState(false);\n\n  // ЛОКАЛЬНОЕ ХРАНИЛИЩЕ\n\n  // Текст запроса\n  const searchWordLocalStorage = localStorage.getItem('searchWord');\n\n  // Обработка регистрации\n\n  function handleRegister (email, password, name) {\n    MainApi.register(email, password, name)\n      .then((res) => {\n        if (res.ok) {\n          // history.push('/movies');\n          setInfoToolTipInfo({\n            message: tooltip.registrationSuccess,\n            image: tooltip.successIcon\n          });\n          handleLogin(email, password);\n        } else {\n          setInfoToolTipInfo({\n            message: tooltip.registrationFail,\n            image: tooltip.successIcon\n          })\n        }\n      })\n      // .then(() => {\n      //   handleLogin(email, password);\n      // })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.registrationFail,\n          image: tooltip.failIcon\n        });\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true);\n      })\n  }\n  \n  // Обработка логина\n\n  function handleLogin (email, password) {\n    if (!email || !password) {\n      console.log('No email or password on login; aborting.');\n      console.log(`Email: ${email}`);\n      console.log(`Password: ${password}`);\n      return;\n    }\n    \n    MainApi.login(email, password)\n      .then((data) => {\n        if(!data.jwt) {\n          throw new Error('Произошла ошибка (авторизации на фронте)');\n        }\n        setIsLoggedIn(true);\n        localStorage.setItem('jwt', data.jwt);\n        localStorage.setItem('searchResults', []);\n        localStorage.setItem('filterState', false);\n        localStorage.setItem('filterStateInSaved', false);\n        localStorage.setItem('searchWord', '');\n        localStorage.setItem('searchWordInSaved', '');\n        return data._id;\n      })\n      .then((id) => {\n        tokenCheck();\n        setCurrentUser({\n          _id: id,\n        });\n        setInfoToolTipInfo({\n          message: tooltip.loginSuccess,\n          image: tooltip.successIcon\n        });\n        history.push('/movies');\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.loginFail,\n          image: tooltip.failIcon\n        });\n      })\n      .finally(() => {\n        console.log(`Before Popup open: ${isLoggedIn}`)\n        setIsInfoToolTipOpen(true);\n      });\n  }\n\n  // Обработка обновления профиля\n\n  function handleEditProfileSubmit (name, email) {\n    MainApi.editProfile(name, email)\n      .then((data) => {\n        setCurrentUser(data);\n        setInfoToolTipInfo({\n          message: tooltip.updateSuccess,\n          image: tooltip.successIcon\n        })\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.updateFail,\n          image: tooltip.failIcon\n        })\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true)\n      });\n  }\n\n  function handleLogOut () {\n    localStorage.removeItem('jwt');\n    localStorage.removeItem('searcResults');\n    localStorage.removeItem('searchWord');\n    localStorage.removeItem('searchWordInSaved');\n    localStorage.removeItem('filterState');\n    localStorage.removeItem('filterStateInSaved');\n    setIsLoggedIn(false);\n    setCurrentUser({});\n    setMovies([]);\n    setSavedMovies([]);\n    history.push('/');\n  }\n\n  function closePopups () {\n    setIsInfoToolTipOpen(false);\n  }\n\n  // Добавить фильм в библиотеку сохраненных фильмов\n  // или оповестить юзера об ошибке\n\n  function handleSetLike(movie) {\n\n    const isSaved = savedMovies.find((savedMovie) => savedMovie.movieId  === movie.movieId);\n\n    if(isSaved === undefined) {\n      MainApi.createLocalCard(movie)\n      .then((data) => {\n        console.log(data);\n        const createdMovie = data.movie;\n\n        setInfoToolTipInfo({\n          message: tooltip.saveSuccess,\n          image: tooltip.successIcon\n        });\n        setSavedMovies([createdMovie, ...savedMovies]);\n      })\n      .catch((err) => {\n        setInfoToolTipInfo({\n          message: tooltip.saveFail,\n          image: tooltip.failIcon\n        });\n        setIsInfoToolTipOpen(true);\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true);\n      })\n    } else {\n      setInfoToolTipInfo({\n        message: tooltip.saveFailRepeat,\n        image: tooltip.failIcon\n      });\n      setIsInfoToolTipOpen(true);\n    } \n  }\n\n  function handleRemoveLike (movie) {\n    // console.log(`In App handleRemoveLike movie: id: ${movie.movieId}`);\n    MainApi.deleteLocalMovie(movie.movieId)\n      .then(() => {\n        setSavedMovies((savedMovies) => savedMovies.filter((m) => m.movieId !== movie.movieId));\n        setInfoToolTipInfo({\n          message: tooltip.removeSuccess,\n          image: tooltip.successIcon\n        });\n      })\n      .catch((err) => {\n        console.log(err);\n        setInfoToolTipInfo({\n          message: tooltip.removeFail,\n          image: tooltip.failIcon\n        });\n      })\n      .finally(() => {\n        setIsInfoToolTipOpen(true);\n      });\n  }\n\n  // Переключатель состояния фильтра короткометражек\n  // Переписывает значение фильтра на локальном диске и \n  // переменной состояния\n\n  function toggleCheckBox() {\n    const filter = JSON.parse(localStorage.getItem('filterState'));\n    localStorage.setItem('filterState', !filter);\n    setIsShortMovieChecked(!filter);\n    // console.log(`FILTER STATE (LOCAL) ON TOGGLE IS ${localStorage.getItem('filterState')}`);\n    // console.log(`FILTER STATE (STATE) ON TOGGLE IS ${isShortMovieChecked}`);\n  }\n\n  // Функция по фильтрации массивов с фильмами по ключевому слову\n  // и длительности\n\n  function filterBySearchWord(list, word, isShortOn) {\n    if (list.length > 0) {\n      if (isShortOn === true) {\n        return list.filter((movie) => movie.nameRU.toLowerCase().includes(word.toLowerCase()) && movie.duration < 40);\n      } else {\n        return list.filter((movie) => movie.nameRU.toLowerCase().includes(word.toLowerCase()));\n      }\n    } else {\n      return [];\n    }\n  }\n\n\n  function handleSearchRequest(word, filterState) {\n    setIsLoading(true);\n\n    // console.log(`IN SEARCH HANDLER: ${JSON.parse(localStorage.getItem('filterState'))}`);\n\n    setTimeout(() => {\n\n      const movieList = filterBySearchWord(movies, word, filterState);\n\n      if(movieList !== null && movieList.length !== 0) {\n        localStorage.setItem('searchResults', JSON.stringify(movieList));\n        setIsNoResuls(false);\n      } else {\n        localStorage.setItem('searchResults', []);\n        setIsNoResuls(true);\n      }\n\n      localStorage.setItem('filterState', filterState);\n      localStorage.setItem('searchWord', word);\n      setMovieSearchResult(movieList);\n      setIsLoading(false);\n    }, 1000);\n  }\n\n  function handleSearchRequestInSaved(word, filterState) {\n    setIsLoading(true);\n\n    setTimeout(() => {\n      console.log(`In filterinf saved movies: ${filterState}`);\n      const movieList = filterBySearchWord(savedMovies, word, filterState);\n\n      if(movieList !== null && movieList.length !== 0) {\n        setIsNoResuls(false);\n      } else {\n        setIsNoResuls(true);\n      }\n\n      localStorage.setItem('filterStateInSaved', filterState);\n      setSavedMovieSearchResult(movieList);\n      setAreSavedMoviesFiltered(true);\n      setIsLoading(false);\n    }, 1000);\n  }\n\n  function resetAreSavedMoviesFiltered () {\n    setAreSavedMoviesFiltered(false);\n  }\n\n  // Проверяем наличие токена в локальном хранилище\n  // если токен присутствует - \n  // меняем состояние логина и\n  // забираем данные о юзере с сервера и сохранем в переменную состояния. \n\n  function tokenCheck () {\n    const jwt = localStorage.getItem('jwt');\n\n    // console.log('ACTION 1 (tokenCheck)');\n    // console.log(`Token in tokenCheck: ${jwt}`);\n    // console.log(`777777777 Token in tokenCheck: idLoggedIn ${isLoggedIn}`);\n    // console.log(`22222 In getSearchResults: ${movieSearchResult}`);\n\n    if (jwt) {\n      MainApi.getContent(jwt)\n        .then((user) => {\n          if (user) {\n            setCurrentUser(user);\n            setIsLoggedIn(true);\n            setMovieSearchResult(getSearchResults);\n            setIsShortMovieChecked(JSON.parse(localStorage.getItem('filterState')));\n            // console.log(`isShortMovieChecked ${isShortMovieChecked}`)\n            if (location.pathname === '/signin') {\n              history.push('/movies');\n            } else if (location.pathname === '/signup') {\n              history.push('/movies');\n            } else {\n              history.push(location.pathname);\n            }            \n            // console.log(`Token in tokenCheck: idLoggedIn ${isLoggedIn}`);\n\n            // console.log(`In tokenCheck: getContent currentUSer: ${currentUser}`);\n            // console.log(`In tokenCheck: getContent response: ${JSON.stringify(user)}`);\n          } else {\n            localStorage.removeItem('jwt');\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n          localStorage.removeItem('jwt');\n        })\n    }\n  }\n\n  // Извлекает и записывает данные с локального хранилища в переменную состояния\n\n  function getSearchResults() {\n    return localStorage.getItem('searchResults').length > 0 ?\n      JSON.parse(localStorage.getItem('searchResults')) :\n      [];\n  }\n\n  // Если пользователь залогинен\n  // получаем все фильмы с API и сохраненные юзером фильмы\n\n  useEffect(() => {\n    if(isLoggedIn) {\n      console.log(`Fetching movies...`);\n      console.log('ACTION 2 (about to fetch movies)');\n\n      Promise.all([\n        MoviesApi.getMovies(),\n        MainApi.getSavedMovies()\n      ])\n      .then(([allMovies, userSavedMovies]) => {\n        // console.log('ACTION 3 (about to set movies and savedMovies)');\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${allMovies.length}`);\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${JSON.stringify(allMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: allMovies: ${Array.isArray(allMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${userSavedMovies.length}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${JSON.stringify(userSavedMovies)}`);\n        // console.log(`In MainApi.getSavedMovies: savedMovies: ${Array.isArray(userSavedMovies)}`);\n        setMovies(allMovies);\n        if (userSavedMovies) {\n          const filteredMovies = userSavedMovies.filter((m) => m.owner === currentUser._id);\n          setSavedMovies(filteredMovies !== undefined ? filteredMovies : []);\n          // console.log(`In MainApi.getSavedMovies: savedMovies: ${savedMovies}`);\n        } else {\n          setSavedMovies([]);\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n    }    \n  }, [isLoggedIn])\n\n  // Проверяем токен при передвижению по сайту\n  // Перезаписываем отфильтрованные фильмы в переменную состояния\n  // из локального хранилища\n\n  useEffect(() => {\n    tokenCheck();\n  }, []);\n  \n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"app\">\n        <Switch>\n          <Route exact path=\"/\">\n            <Main\n              isLoggedIn={isLoggedIn} />\n          </Route>\n\n          <ProtectedRoute\n            path=\"/movies\"\n            component={Movies}\n            movies={movieSearchResult}\n            savedMovies={savedMovies}\n            searchWord={searchWordLocalStorage}\n            handleSetLike={handleSetLike}\n            handleRemoveLike={handleRemoveLike}\n            onSearch={handleSearchRequest}\n            handleCheckboxToggle={toggleCheckBox}\n            isLoggedIn={isLoggedIn}\n            isShortMovieChecked={isShortMovieChecked}\n            isNoResults={isNoResults}\n            isLoading={isLoading} />\n\n          <ProtectedRoute\n            path=\"/saved-movies\"\n            component={SavedMovies}\n            movies={areSavedMoviesFiltered ? savedMovieSearchResult : savedMovies}\n            savedMovies={savedMovies}\n            savedMovieSearchResult={savedMovieSearchResult}\n            areSavedMoviesFiltered={areSavedMoviesFiltered}\n            handleRemoveLike={handleRemoveLike}\n            onSearch={handleSearchRequest}\n            onSavedSearch={handleSearchRequestInSaved}\n            handleCheckboxToggle={toggleCheckBox}\n            isLoggedIn={isLoggedIn}\n            isShortMovieChecked={isShortMovieChecked}\n            isNoResults={isNoResults}\n            resetAreSavedMoviesFiltered={resetAreSavedMoviesFiltered} />\n\n          <ProtectedRoute\n            path=\"/profile\"\n            component={Profile}\n            onSubmit={handleEditProfileSubmit}\n            onLogOut={handleLogOut}\n            isLoggedIn={isLoggedIn} />\n\n          <Route path=\"/signin\">\n            <Login\n              handleLogin={handleLogin} />\n          </Route>\n\n          <Route path=\"/signup\">\n            <Register\n              handleRegister={handleRegister} />\n          </Route>\n\n          <Route path=\"*\">\n            <Page404 />\n          </Route>\n        </Switch>\n\n        <InfoTooltip\n          isOpen={isInfoToolTipOpen}\n          onClose={closePopups}\n          info={infoToolTipInfo} />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}